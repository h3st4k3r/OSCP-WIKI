`lsof` (List Open Files) muestra todos los archivos abiertos por procesos. En Linux, todo se trata como archivo (sockets, pipes, ejecutables, etc.), por lo que `lsof` es extremadamente útil durante la post-explotación.

Permite:
- Ver conexiones de red activas con detalles de proceso
- Detectar archivos temporales o ejecutables sospechosos
- Analizar qué procesos tienen archivos bloqueados o en uso

---

## 1. Listar todo
```bash
lsof
```

---

## 2. Ver puertos abiertos y conexiones activas
```bash
lsof -i
```
Filtrar por protocolo o puerto:
```bash
lsof -iTCP -sTCP:LISTEN
lsof -i :80
```

---

## 3. Ver procesos que acceden a un archivo específico
```bash
lsof /etc/passwd
```

---

## 4. Ver archivos abiertos por un proceso concreto
```bash
lsof -p <PID>
```

---

## 5. Ver archivos eliminados aún en uso
```bash
lsof | grep deleted
```
Muy útil para ver malware temporal aún en ejecución aunque ya no exista en disco.

---

## 6. Ver archivos abiertos por un usuario
```bash
lsof -u root
```

---

## 7. Ficheros abiertos por tipo
```bash
lsof +D /ruta     # Archivos bajo ese directorio
lsof -nP           # Sin resolución DNS ni nombres
```

---

## Uso OSCP-style
- Identificar conexiones activas no detectadas por `netstat`
- Detectar payloads en ejecución
- Revisar actividad de servicios sospechosos

---
